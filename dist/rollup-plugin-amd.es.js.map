{"version":3,"file":"rollup-plugin-amd.es.js","sources":["../src/index.js"],"sourcesContent":["import convert from '@buxlabs/amd-to-es6';\r\nimport { createFilter } from 'rollup-pluginutils';\r\n\r\nconst firstpass = /\\b(?:define)\\b/;\r\nconst importStatement = /\\b(import .*['\"])(.*)(['\"].*\\n)/g;\r\n\r\nexport default function(options = {}) {\r\n    const filter = createFilter( options.include, options.exclude );\r\n\r\n    return {\r\n        name: 'amd',\r\n\r\n        transform (code, id) {\r\n            if ( !filter( id ) ) return;\r\n            if ( !firstpass.test( code ) ) return;\r\n\r\n            let transformed = convert(code);\r\n            if (options.rewire) {\r\n                transformed = transformed.replace(importStatement, (match, begin, moduleId, end) => {\r\n                    return `${begin}${options.rewire(moduleId, id) || moduleId}${end}`;\r\n                });\r\n            }\r\n\r\n            return transformed;\r\n        }\r\n    };\r\n}\r\n"],"names":["const","let"],"mappings":";;;AAGAA,IAAM,SAAS,GAAG,gBAAgB,CAAC;AACnCA,IAAM,eAAe,GAAG,kCAAkC,CAAC;;AAE3D,AAAe,eAAS,OAAY,EAAE;qCAAP,GAAG;;IAC9BA,IAAM,MAAM,GAAG,YAAY,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,EAAE,CAAC;;IAEhE,OAAO;QACH,IAAI,EAAE,KAAK;;QAEX,6BAAS,EAAE,IAAI,EAAE,EAAE,EAAE;YACjB,KAAK,CAAC,MAAM,EAAE,EAAE,EAAE,KAAG,SAAO;YAC5B,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,KAAG,SAAO;;YAEtCC,IAAI,WAAW,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;YAChC,IAAI,OAAO,CAAC,MAAM,EAAE;gBAChB,WAAW,GAAG,WAAW,CAAC,OAAO,CAAC,eAAe,YAAG,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE;oBAC7E,aAAU,KAAK,IAAG,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC,IAAI,QAAQ,IAAG,GAAG,EAAG;iBACtE,CAAC,CAAC;aACN;;YAED,OAAO,WAAW,CAAC;SACtB;KACJ,CAAC;CACL;;;;"}